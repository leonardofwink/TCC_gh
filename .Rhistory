stat_summary(
fun.data = f,
geom = 'errorbar',
width = 0.3,
position = position_dodge(width = 0.65),
)+
stat_summary(
fun.data = f,
geom = "boxplot",
width = 0.7,
fill = '#F8F8FF',
color = "black",
outlier.shape = NA, #se deixar NA fica só o jitter, se não, deixa 1
)+
labs(title = titulo,
x="Estação",
y="µmhos/cm")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.05)),
n.breaks = 8,
limits = c(
# min(plan_wide_19902020$condutividade, na.rm = TRUE),
5,
1000
# max(plan_wide_19902020$condutividade, na.rm = TRUE)
),
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "),
trans = "log10")+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_x_discrete(limits = c("87398500",
"87398980",
"87398900",
"87398950",
"87405500",
"87406900",
"87409900"),
labels = c("PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PM7")
)+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
theme_grafs()
}
# Chunk 26: Gráfico OD facetted
(od <- plan_wide_19902020 %>%
boxplot_od(
titulo = "Oxigênio Dissolvido no período 1990-2020",
)+
facet_wrap(~periodo)
)
(iqaod_p1 <-ggplot(plan_wide_19902020 %>%
filter(ano_coleta > "1990" &
ano_coleta <= "2000"),
aes(codigo,
iqa_od, na.rm = TRUE))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=19,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=19,
ymax=36,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=36,
ymax=51,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=51,
ymax=79,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=79,
ymax=Inf,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_summary(
fun.data = f,
geom = 'errorbar',
width = 0.3,
position = position_dodge(width = 0.65),
)+
stat_summary(
fun.data = f,
geom = "boxplot",
width = 0.7,
fill = '#F8F8FF',
color = "black",
outlier.shape = NA, #se deixar NA fica só o jitter, se não, deixa 1
)+
labs(title = "Variação do IQA para o parâmetro Oxigênio Dissolvido 1990-2000",
x="Estação",
y="")+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_x_discrete(limits = c("87398500",
"87398980",
"87398900",
"87398950",
"87405500",
"87406900",
"87409900"),
labels = c("PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PM7")
)+
scale_y_continuous(expand = expansion(mult = c(0,0)),
n.breaks = 6,
limits = c(-1,101))+
geom_smooth(
method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
linewidth = 1
)+
theme_grafs()
)
boxplot_dbo()
(dbo <- plan_wide_19902020 %>%
boxplot_dbo(
titulo = "Demanda Bioquímica de Oxigênio no período 1990-2020",
)+
facet_wrap(~periodo)
)
(dbo_p1 <- plan_wide_19902020 %>%
filter(ano_coleta>"1990" &
ano_coleta<="2000") %>%
boxplot_dbo(
titulo = "Demanda Bioquímica de Oxigênio no período 1990-2000",
)
)
(dbo_p2 <- plan_wide_19902020 %>%
filter(ano_coleta>"2000" &
ano_coleta<="2010") %>%
boxplot_dbo(
titulo = "Demanda Bioquímica de Oxigênio no período 2000-2010",
)
)
(dbo_p3 <- plan_wide_19902020 %>%
filter(ano_coleta>"2010" &
ano_coleta<="2020") %>%
boxplot_dbo(
titulo = "Demanda Bioquímica de Oxigênio no período 2010-2020",
)
)
boxplot_ptot()
(ptot <- plan_wide_19902020 %>%
boxplot_ptot(
titulo = "Fósforo total no período 1990-2020",
)+
facet_wrap(~periodo)
)
(ptot_p1 <- plan_wide_19902020%>%
filter(ano_coleta>"1990" &
ano_coleta<="2000") %>%
boxplot_ptot(
titulo = "Fósforo total no período 1990-2000",
)
)
(ptot_p2 <- plan_wide_19902020%>%
filter(ano_coleta>"2000" &
ano_coleta<="2010") %>%
boxplot_ptot(
titulo = "Fósforo total no período 2000-2010",
)
)
(ptot_p1 <- plan_wide_19902020%>%
filter(ano_coleta>"1990" &
ano_coleta<="2000") %>%
boxplot_ptot(
titulo = "Fósforo total no período 1990-2000",
)
)
(ptot_p2 <- plan_wide_19902020%>%
filter(ano_coleta>"2000" &
ano_coleta<="2010") %>%
boxplot_ptot(
titulo = "Fósforo total no período 2000-2010",
)
)
(ptot <- plan_wide_19902020 %>%
boxplot_ptot(
titulo = "Fósforo total no período 1990-2020",
)+
facet_wrap(~periodo)
)
(ptot_p3 <- plan_wide_19902020 %>%
filter(ano_coleta>"2010" &
ano_coleta<="2020") %>%
boxplot_ptot(
titulo = "Fósforo total no período 2010-2020",
)
)
(ecoli <- boxplot_ecoli(
titulo = "*Escherichia coli* no período 1990-2020"
)+
facet_wrap(~periodo)
)
(ecoli <- ggplot(plan_wide_19902020,
aes(codigo,
escherichia_coli))+
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=3200, ymax=Inf,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=800, ymax=3200,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=160, ymax=800,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=0, ymax=160,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_summary(
fun.data = f,
geom = 'errorbar',
width = 0.3,
position = position_dodge(width = 0.65),
)+
stat_summary(
fun.data = f,
geom = "boxplot",
width = 0.7,
fill = '#F8F8FF',
color = "black",
outlier.shape = NA, #se deixar NA fica só o jitter, se não, deixa 1
)+
facet_wrap(~periodo)+
labs(title = "*Escherichia coli* no período 1990-2020",
x="Estação",
y="NMP/100mL")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
# n.breaks = 9,
n.breaks = 6,
limits = c(min(plan_wide_19902020$escherichia_coli, na.rm = TRUE),
max(plan_wide_19902020$escherichia_coli, na.rm = TRUE)),
trans = "log10",
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_x_discrete(limits = c("87398500",
"87398980",
"87398900",
"87398950",
"87405500",
"87406900",
"87409900"),
labels = c("PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PM7")
)+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
linewidth = 1)+
theme_grafs()+
theme(
axis.text.y = element_text(
angle = 90,
# size=15,
# face=2
),
plot.title =
element_markdown(
hjust = 0.5,
color = "black",
size = 19)
)
)
(ecoli <- ggplot(plan_wide_19902020,
aes(codigo,
escherichia_coli))+
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=3200, ymax=Inf,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=800, ymax=3200,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=160, ymax=800,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=0, ymax=160,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_summary(
fun.data = f,
geom = 'errorbar',
width = 0.3,
position = position_dodge(width = 0.65),
)+
stat_summary(
fun.data = f,
geom = "boxplot",
width = 0.7,
fill = '#F8F8FF',
color = "black",
outlier.shape = NA, #se deixar NA fica só o jitter, se não, deixa 1
)+
facet_wrap(~periodo)+
labs(title = "*Escherichia coli* no período 1990-2020",
x="Estação",
y="NMP/100mL")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
# n.breaks = 9,
n.breaks = 6,
limits = c(min(plan_wide_19902020$escherichia_coli, na.rm = TRUE),
max(plan_wide_19902020$escherichia_coli, na.rm = TRUE)),
trans = "log10",
# labels = scales::number_format(accuracy = 1,
#                                decimal.mark = ",",
#                                big.mark = " ")
)+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_x_discrete(limits = c("87398500",
"87398980",
"87398900",
"87398950",
"87405500",
"87406900",
"87409900"),
labels = c("PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PM7")
)+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
linewidth = 1)+
theme_grafs()+
theme(
axis.text.y = element_text(
angle = 90,
# size=15,
# face=2
),
plot.title =
element_markdown(
hjust = 0.5,
color = "black",
size = 19)
)
)
(ecoli <- boxplot_ecoli(
titulo = "*Escherichia coli* no período 1990-2020"
)+
facet_wrap(~periodo)
)
(ecoli <- ggplot(plan_wide_19902020,
aes(codigo,
escherichia_coli))+
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=3200, ymax=Inf,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=800, ymax=3200,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=160, ymax=800,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf, xmax=Inf,
ymin=0, ymax=160,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_summary(
fun.data = f,
geom = 'errorbar',
width = 0.3,
position = position_dodge(width = 0.65),
)+
stat_summary(
fun.data = f,
geom = "boxplot",
width = 0.7,
fill = '#F8F8FF',
color = "black",
outlier.shape = NA, #se deixar NA fica só o jitter, se não, deixa 1
)+
facet_wrap(~periodo)+
labs(title = "*Escherichia coli* no período 1990-2020",
x="Estação",
y="NMP/100mL")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
# n.breaks = 9,
n.breaks = 6,
limits = c(min(plan_wide_19902020$escherichia_coli, na.rm = TRUE),
max(plan_wide_19902020$escherichia_coli, na.rm = TRUE)),
trans = "log10",
# labels = scales::number_format(accuracy = 1,
#                                decimal.mark = ",",
#                                big.mark = " ")
)+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_x_discrete(limits = c("87398500",
"87398980",
"87398900",
"87398950",
"87405500",
"87406900",
"87409900"),
labels = c("PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PM7")
)+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
linewidth = 1)+
theme_grafs()+
theme(
axis.text.y = element_text(
angle = 90,
# size=15,
# face=2
),
plot.title =
element_markdown(
hjust = 0.5,
color = "black",
size = 19)
)
)
(ecoli <- boxplot_ecoli(
titulo = "*Escherichia coli* no período 1990-2020"
)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
# n.breaks = 9,
n.breaks = 6,
limits = c(min(plan_wide_19902020$escherichia_coli, na.rm = TRUE),
max(plan_wide_19902020$escherichia_coli, na.rm = TRUE)),
trans = "log10",
# labels = scales::number_format(accuracy = 1,
#                                decimal.mark = ",",
#                                big.mark = " ")
)+
facet_wrap(~periodo)
)
(ecoli <- boxplot_ecoli(
titulo = "*Escherichia coli* no período 1990-2020"
)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
# n.breaks = 9,
n.breaks = 6,
limits = c(min(plan_wide_19902020$escherichia_coli, na.rm = TRUE),
max(plan_wide_19902020$escherichia_coli, na.rm = TRUE)),
trans = "log10",
# labels = scales::number_format(accuracy = 1,
#                                decimal.mark = ",",
#                                big.mark = " ")
)+
facet_wrap(~periodo)
)
