size = 1.2,
alpha = .25,
width = .07,
)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.05)),
n.breaks = 8,
limits = c(0,
max(plan_wide_19902020$Condutividade, na.rm = TRUE)),
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900",
"87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
theme(
plot.title = element_text(
hjust = 0.5,
color = "black",
size = 19),
axis.title.y = element_text(
color = "black",
size = 15),
axis.text.y = element_text(
color = "black",
size = 17),
axis.text.x = element_text(
color = "black",
size = 17),
)
)
# Chunk 77: Gráfico cond_elet periodo2
(cond_elet_p2 <- ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA>"2000" &
ANO_COLETA<="2010"),
aes(CODIGO,
Condutividade))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=500,
ymax=Inf,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=500,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65))+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7)+
labs(title = "Condutividade elétrica no período 1990-2000",
x="Estação",
y="")+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.05)),
n.breaks = 8,
limits = c(0,
max(plan_wide_19902020$Condutividade, na.rm = TRUE)),
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900",
"87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
theme(
plot.title = element_text(
hjust = 0.5,
color = "black",
size = 19),
axis.title.y = element_text(
color = "black",
size = 15),
axis.text.y = element_text(
color = "black",
size = 17),
axis.text.x = element_text(
color = "black",
size = 17),
)
)
# Chunk 78: Gráfico cond_elet periodo3
(cond_elet_p3 <- ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020"),
aes(CODIGO,
Condutividade))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=500,
ymax=Inf,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=500,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65))+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7)+
labs(title = "Condutividade elétrica no período 1990-2000",
x="Estação",
y="")+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.05)),
n.breaks = 8,
limits = c(0,
max(plan_wide_19902020$Condutividade, na.rm = TRUE)),
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900",
"87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
theme(
plot.title = element_text(
hjust = 0.5,
color = "black",
size = 19),
axis.title.y = element_text(
color = "black",
size = 15),
axis.text.y = element_text(
color = "black",
size = 17),
axis.text.x = element_text(
color = "black",
size = 17),
)
)
# Chunk 79: Gráfico cond_elet 3 periodos juntos
grid.arrange(cond_elet_p1, cond_elet_p2, cond_elet_p3, ncol = 3)
# Chunk 80: Sumário cond_elet
(sum_cond_elet_p1 <- plan_wide_19902020 %>%
select(CODIGO, Condutividade, ANO_COLETA) %>%
filter(ANO_COLETA>"1990" &
ANO_COLETA<="2000") %>%
group_by(CODIGO) %>%
summarize(
min =
min(Condutividade,
na.rm = TRUE),
q1 =
quantile(Condutividade, 0.25,
na.rm = TRUE),
median =
median(Condutividade,
na.rm = TRUE),
mean =
mean(Condutividade,
na.rm= TRUE),
q3 =
quantile(Condutividade, 0.75,
na.rm = TRUE),
max =
max(Condutividade,
na.rm = TRUE))
)
(sum_cond_elet_p2 <- plan_wide_19902020 %>%
select(CODIGO, Condutividade, ANO_COLETA) %>%
filter(ANO_COLETA>"2000" &
ANO_COLETA<="2010") %>%
group_by(CODIGO) %>%
summarize(
min =
min(Condutividade,
na.rm = TRUE),
q1 =
quantile(Condutividade, 0.25,
na.rm = TRUE),
median =
median(Condutividade,
na.rm = TRUE),
mean =
mean(Condutividade,
na.rm= TRUE),
q3 =
quantile(Condutividade, 0.75,
na.rm = TRUE),
max =
max(Condutividade,
na.rm = TRUE))
)
(sum_cond_elet_p3 <- plan_wide_19902020 %>%
select(CODIGO, Condutividade, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(Condutividade,
na.rm = TRUE),
q1 =
quantile(Condutividade, 0.25,
na.rm = TRUE),
median =
median(Condutividade,
na.rm = TRUE),
mean =
mean(Condutividade,
na.rm= TRUE),
q3 =
quantile(Condutividade, 0.75,
na.rm = TRUE),
max =
max(Condutividade,
na.rm = TRUE),
n =
length(Condutividade))
)
# plan_wide_19902020 %>%
#    select(CODIGO, IQA) %>%
#    group_by(CODIGO) %>%
#    summarize(
#       min =
#          min(IQA,
#              na.rm = TRUE),
#       q1 =
#          quantile(IQA, 0.25,
#                   na.rm = TRUE),
#       median =
#          median(IQA,
#                 na.rm = TRUE),
#       mean =
#          mean(IQA,
#               na.rm= TRUE),
#       q3 =
#          quantile(IQA, 0.75,
#                   na.rm = TRUE),
#       max =
#          max(IQA,
#              na.rm = TRUE))
# Chunk 81: Salvando cond_elet
ggsave("cond_elet_p1.png",
plot = cond_elet_p1,
path = "./graficos",
dpi = 300,
type = "cairo")
ggsave("cond_elet_p2.png",
plot = cond_elet_p2,
path = "./graficos",
dpi = 300,
type = "cairo")
ggsave("cond_elet_p3.png",
plot = cond_elet_p3,
path = "./graficos",
dpi = 300,
type = "cairo")
ggsave("cond_elet_3periodos.png",
units = c("px"),
width = 4500,
height = 2993,
plot = grid.arrange(cond_elet_p1, cond_elet_p2, cond_elet_p3, ncol = 3),
path = "./graficos",
dpi = 300,
type = "cairo")
?t()
plan_wide_19902020 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
plan_wide_19902020 <- read_delim("https://raw.githubusercontent.com/leonardofwink/TCC_gh/main/plan_wide_19902020.tsv",
delim = "\t", escape_double = FALSE,
col_types = cols(Alcalinidade = col_double(),
CODIGO = col_character(), COORD_GEO_LAT_GRAU = col_double(),
COORD_GEO_LONG_GRAU = col_double(),
DATA_COLETA = col_date(format = "%d/%m/%Y"),
Nitrato = col_double(), Nitrito = col_double(),
SDT = col_double(), SST = col_double(),
`Vazao` = col_double(), `Vazao rio` = col_double()),
locale = locale(date_names = "pt", decimal_mark = ",",
grouping_mark = ""), trim_ws = TRUE)
plan_wide_19902020 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
(od_p1 <- ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA > "1990" &
ANO_COLETA <= "2000"),
aes(CODIGO,
`Oxigênio dissolvido`))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=2,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=2,
ymax=4,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=4,
ymax=5,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=5,
ymax=6,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=6,
ymax=Inf,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65))+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = NA, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7)+
labs(title = "Oxigênio Dissolvido no período 1990-2000",
x="Estação",
y="mg/L")+
ggbeeswarm::geom_quasirandom(
size = 1.2,
alpha = .25,
width = .07,
)+
scale_y_continuous(
expand = expansion(mult = c(0,0)),
n.breaks = 11,
limits = c(-1,21))+
scale_x_discrete(limits = c("87398500",
"87398980",
"87398900",
"87398950",
"87405500",
"87406900",
"87409900"),
labels = c("PM1", "PM2", "PM3", "PM4", "PM5", "PM6", "PM7")
)+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
theme(
plot.title = element_text(
hjust = 0.5,
color = "black",
size = 19),
axis.title.y = element_text(
color = "black",
size = 15),
axis.text.y = element_text(
color = "black",
size = 17),
axis.text.x = element_text(
color = "black",
size = 17),
)
)
plan_wide_19902020 <- read_delim("https://raw.githubusercontent.com/leonardofwink/TCC_gh/main/plan_wide_19902020.tsv",
delim = "\t",
escape_double = FALSE,
col_types = cols(
Alcalinidade = col_double(),
CODIGO = col_character(),
COORD_GEO_LAT_GRAU = col_double(),
COORD_GEO_LONG_GRAU = col_double(),
DATA_COLETA = col_date(format = "%d/%m/%Y"),
Nitrato = col_double(),
Nitrito = col_double(),
SDT = col_double(),
SST = col_double(),
`Vazao` = col_double(),
`Vazao rio` = col_double()
),
locale = locale(
date_names = "pt",
decimal_mark = ",",
grouping_mark = ""
),
trim_ws = TRUE
)
plan_wide_19902020 %>%
ggplot(
aes(x = CODIGO,
y = .)
)
plan_wide_19902020 %>%
ggplot(
aes(x = CODIGO,
y = `Oxigênio dissolvido`)
)
plan_wide_19902020 %>%
ggplot(
aes(x = CODIGO,
y = `Oxigênio dissolvido`)+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=2,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=2,
ymax=4,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=4,
ymax=5,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=5,
ymax=6,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=6,
ymax=Inf,
alpha=1,
fill="#8dcdeb")+ #classe 1
)
plan_wide_19902020 %>%
ggplot(
aes(x = CODIGO,
y = `Oxigênio dissolvido`)+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=2,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=2,
ymax=4,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=4,
ymax=5,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=5,
ymax=6,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=6,
ymax=Inf,
alpha=1,
fill="#8dcdeb") #classe 1
)
