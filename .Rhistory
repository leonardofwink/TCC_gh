#              ncol = 3, nrow=2)
# Chunk 64: Sumário IQA
(sum_IQA_p1 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"1990" &
ANO_COLETA<="2000") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
)
(sum_IQA_p2 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2000" &
ANO_COLETA<="2010") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
)
(sum_IQA_p3 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE),
n =
length(IQA))
)
plan_wide_19902020 %>%
select(CODIGO, IQA) %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
# Chunk 65: Testando coisas
# ggplot(mtcars, aes(x=hp, y=wt)) +
#   geom_point() +
#   geom_smooth()
#
# iris %>%
#   qplot(Sepal.Length, Sepal.Width,
#         colour = Species, fill=Species, data=.) +
#   geom_smooth(method=lm)
#
#
# df111 <- data.frame(x = c(1:100))
# glimpse(df111)
# df111$y <- 2 + 3 * df111$x + rnorm(100, sd = 40)
# p111 <- ggplot(data = df111, aes(x = x, y = y)) +
#             geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
#             geom_point()
# p111
#
# lm_eqn <- function(df111){
#     m <- lm(y ~ x, df111);
#     eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
#          list(a = format(unname(coef(m)[1]), digits = 2),
#               b = format(unname(coef(m)[2]), digits = 2),
#              r2 = format(summary(m)$r.squared, digits = 3)))
#     as.character(as.expression(eq));
# }
#
# p2 <- p111 +
#   geom_text(x = 25, y = 300,
#             label = lm_eqn(df111),
#             parse = TRUE)
# install.packages("ggpmisc")
# library(ggpmisc)
# summary(lm(plan_wide_19902020$CODIGO~plan_wide_19902020$DBO))
#
#
# p <- ggplot(data, aes(y=number, x=pod)) +
#   geom_boxplot()
# print(p)
# install.packages("GGally")
library(GGally)
parametros_IQA %>%
select(-`Nitrogênio amoniacal`, -CODIGO) %>%
ggcorr(method = "complete.obs",
label = TRUE,
label_alpha = TRUE)
# install.packages("basedosdados")
# library(basedosdados)
fit = lm(plan_wide_19902020$`Oxigênio dissolvido`~ plan_wide_19902020$CODIGO)
summary(fit)
summary.lm(fit)
plan_wide_19902020$IQA
plan_wide_19902020 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
# Chunk 66: Código Gráfico CondElet periodo1
(Cond_elet_p1 <- ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA>"1990" &
ANO_COLETA<="2000"),
aes(CODIGO,
Condutividade))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=500,
ymax=Inf,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=500,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65))+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7)+
labs(title = "Condutividade elétrica no período 1990-2000",
x="Estação",
y="")+
# geom_jitter(width = .05,
#             alpha=.2,
#             size=1.5,
#             color="black")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.05)),
n.breaks = 8,
limits = c(0,
max(plan_wide_19902020$Condutividade, na.rm = TRUE)),
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900", "87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
# geom_line(aes(color="red"),
#           alpha=.0)+
# scale_color_manual("Legenda",
#                    guide="legend",
#                    values = c("Pior Classe"="#ac5079",
#                               "Classe 3"="#fcf7ab",
#                               "Classe 1"="#8dcdeb"))+
# guides(color=guide_legend(override.aes = list(linetype=c(1,1,1),
#                                               lwd=c(2,2,2),
#                                               shape=c(NA,NA,NA),
#                                               alpha=1)))+
theme_classic())
plan_wide_19902020 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
plan_wide_19902020$IQA
fit = lm(plan_wide_19902020$`Oxigênio dissolvido`~ plan_wide_19902020$CODIGO)
summary(fit)
parametros_IQA %>%
select(-`Nitrogênio amoniacal`, -CODIGO) %>%
ggcorr(method = "complete.obs",
label = TRUE,
label_alpha = TRUE)
8.26772*3
plan_wide_19902020 %>%
select(CODIGO, `Oxigênio dissolvido`, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
tbl_summary(by = ANO_COLETA) %>%
add_overall() %>%
add_n() %>%
add_stat()
grid.arrange(od_p1, od_p2, od_p3, ncol = 3)
8.26772*3
grid.arrange(ecoli_p1, ecoli_p2, ecoli_p3, ncol = 3)
(ecoli_p1 <- ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA>"1990" &
ANO_COLETA<="2000"),
aes(CODIGO,
`Escherichia coli`))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=3200,
ymax=Inf,
alpha=1,
fill="#ac5079")+ #>pior classe
#annotate("rect",
#        xmin=-Inf,
#       xmax=Inf,
#      ymin=2,
#     ymax=4,
#    alpha=1,
#   fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=800,
ymax=3200,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=160,
ymax=800,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=0,
ymax=160,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65))+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7)+
labs(title = "Escherichia coli no período 1990-2000",
x="Estação",
y="NMP/100mL")+
# geom_jitter(width = .05,
#             alpha=.2,
#             size=1.5,
#             color="black")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
n.breaks = 9,
limits = c(min(plan_wide_19902020$`Escherichia coli`, na.rm = TRUE),
max(plan_wide_19902020$`Escherichia coli`, na.rm = TRUE)),
trans = "log10",
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900", "87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
# geom_line(aes(color="red"),
#           alpha=.0)+
# scale_color_manual("Legenda",
#                    guide="legend",
#                    values = c("Pior Classe"="#ac5079",
#                               "Classe 3"="#fcf7ab",
#                               "Classe 2"="#70c18c",
#                               "Classe 1"="#8dcdeb"))+
# guides(color=guide_legend(override.aes = list(linetype=c(1,1,1,1),
#                                               lwd=c(2,2,2,2),
#                                               shape=c(NA,NA,NA,NA),
#                                               alpha=1)))+
theme_classic())
(sum_ecoli_p2 <- plan_wide_19902020 %>%
select(CODIGO, `Escherichia coli`, ANO_COLETA) %>%
filter(ANO_COLETA>"2000" &
ANO_COLETA<="2010") %>%
group_by(CODIGO) %>%
summarize(
min =
min(`Escherichia coli`,
na.rm = TRUE),
q1 =
quantile(`Escherichia coli`, 0.25,
na.rm = TRUE),
median =
median(`Escherichia coli`,
na.rm = TRUE),
mean =
mean(`Escherichia coli`,
na.rm= TRUE),
q3 =
quantile(`Escherichia coli`, 0.75,
na.rm = TRUE),
max =
max(`Escherichia coli`,
na.rm = TRUE))
)
(sum_ecoli_p3 <- plan_wide_19902020 %>%
select(CODIGO, `Escherichia coli`, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(`Escherichia coli`,
na.rm = TRUE),
q1 =
quantile(`Escherichia coli`, 0.25,
na.rm = TRUE),
median =
median(`Escherichia coli`,
na.rm = TRUE),
mean =
mean(`Escherichia coli`,
na.rm= TRUE),
q3 =
quantile(`Escherichia coli`, 0.75,
na.rm = TRUE),
max =
max(`Escherichia coli`,
na.rm = TRUE))
)
(sum_ecoli_p1 <- plan_wide_19902020 %>%
select(CODIGO, `Escherichia coli`, ANO_COLETA) %>%
filter(ANO_COLETA>"1990" &
ANO_COLETA<="2000") %>%
group_by(CODIGO) %>%
summarize(
min =
min(`Escherichia coli`,
na.rm = TRUE),
q1 =
quantile(`Escherichia coli`, 0.25,
na.rm = TRUE),
median =
median(`Escherichia coli`,
na.rm = TRUE),
mean =
mean(`Escherichia coli`,
na.rm= TRUE),
q3 =
quantile(`Escherichia coli`, 0.75,
na.rm = TRUE),
max =
max(`Escherichia coli`,
na.rm = TRUE))
)
(sum_ecoli_p2 <- plan_wide_19902020 %>%
select(CODIGO, `Escherichia coli`, ANO_COLETA) %>%
filter(ANO_COLETA>"2000" &
ANO_COLETA<="2010") %>%
group_by(CODIGO) %>%
summarize(
min =
min(`Escherichia coli`,
na.rm = TRUE),
q1 =
quantile(`Escherichia coli`, 0.25,
na.rm = TRUE),
median =
median(`Escherichia coli`,
na.rm = TRUE),
mean =
mean(`Escherichia coli`,
na.rm= TRUE),
q3 =
quantile(`Escherichia coli`, 0.75,
na.rm = TRUE),
max =
max(`Escherichia coli`,
na.rm = TRUE))
)
(ecoli_p2 <- ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA>"2000" &
ANO_COLETA<="2010"),
aes(CODIGO,
`Escherichia coli`))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=3200,
ymax=Inf,
alpha=1,
fill="#ac5079")+ #>pior classe
#annotate("rect",
#        xmin=-Inf,
#       xmax=Inf,
#      ymin=2,
#     ymax=4,
#    alpha=1,
#   fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=800,
ymax=3200,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=160,
ymax=800,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=0,
ymax=160,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65))+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7)+
labs(title = "Escherichia coli no período 2000-2010",
x="Estação",
y="NMP/100mL")+
# geom_jitter(width = .05,
#             alpha=.2,
#             size=1.5,
#             color="black")+
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01)),
n.breaks = 9,
limits = c(min(plan_wide_19902020$`Escherichia coli`, na.rm = TRUE),
max(plan_wide_19902020$`Escherichia coli`, na.rm = TRUE)),
trans = "log10",
labels = scales::number_format(accuracy = 1,
decimal.mark = ",",
big.mark = " "))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900", "87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
# geom_line(aes(color="red"),
#           alpha=.0)+
# scale_color_manual("Legenda",
#                    guide="legend",
#                    values = c("Pior Classe"="#ac5079",
#                               "Classe 3"="#fcf7ab",
#                               "Classe 2"="#70c18c",
#                               "Classe 1"="#8dcdeb"))+
# guides(color=guide_legend(override.aes = list(linetype=c(1,1,1,1),
#                                               lwd=c(2,2,2,2),
#                                               shape=c(NA,NA,NA,NA),
#                                               alpha=1)))+
theme_classic())
grid.arrange(namon_p1, namon_p2, namon_p3,
pH_p1, pH_p2, pH_p3,
ncol = 3, nrow=2)
1000/36
grid.arrange(dbo_p1, dbo_p2, dbo_p3, ncol = 3)
parametros_IQA %>%
select(-`Nitrogênio amoniacal`, -CODIGO) %>%
ggcorr(method = "complete.obs",
label = TRUE,
label_alpha = TRUE)
