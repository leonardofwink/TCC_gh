SDT = col_double(), SST = col_double(),
`Vazao` = col_double(), `Vazao rio` = col_double()),
locale = locale(date_names = "pt", decimal_mark = ",",
grouping_mark = ""), trim_ws = TRUE)
plan_wide_19902020
plan_wide_19902020$`Oxigênio dissolvido`
plan_wide_19902020$IQA
plan_wide_19902020 %>%
select(CODIGO, IQA) %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
plan_wide_19902020 %>%
select(CODIGO, IQA) %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
plan_wide_19902020 %>%
select(CODIGO, IQA) %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
str(plan_wide_19902020 %>%
select(CODIGO, IQA) %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE)))
plan_wide_19902020[plan_wide_19902020$IQA == 0] <- NA
plan_wide_19902020["IQA"]
plan_wide_19902020["IQA"][plan_wide_19902020$IQA == 0] <- NA
plan_wide2 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
View(plan_wide2)
(sum_IQA_p3 <- plan_wide2 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
)
(sum_IQA_p3 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
)
plan_wide_19902020 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
plan_wide_19902020$IQA
grid.arrange(iqa_p1, iqa_p2, iqa_p3, ncol = 3)
plan_wide_19902020 <- plan_wide_19902020 %>%
mutate(IQA = ifelse(IQA == 0, NA, IQA))
(iqa_p1 <-ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA > "1990" &
ANO_COLETA <= "2000"),
aes(CODIGO,
IQA, na.rm = TRUE))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=19,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=19,
ymax=36,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=36,
ymax=51,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=51,
ymax=79,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=79,
ymax=Inf,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65),
na.rm = TRUE)+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7,
na.rm = TRUE)+
labs(title = "Variação do IQA no período 1990-2000",
x="Estação",
y="")+
# geom_jitter(width = .05,
#             alpha=.2,
#             size=1.5,
#             color="black")+
scale_y_continuous(expand = expansion(mult = c(0,0)),
n.breaks = 6,
limits = c(-1,101))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900", "87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
# geom_line(aes(color="red"),
#           alpha=.0)+
# scale_color_manual("Legenda",
#                    guide="legend",
#                    values = c("Ótima"="#8dcdeb",
#                               "Boa"="#70c18c",
#                               "Regular"="#fcf7ab",
#                               "Ruim"="#eb5661",
#                               "Péssima"="#ac5079"))+
# guides(color=guide_legend(override.aes = list(linetype=c(1,1,1,1,1),
#                                               lwd=c(2,2,2,2,2),
#                                               shape=c(NA,NA,NA,NA,NA),
#                                               alpha=1)))+
theme(legend.position = "bottom")+
theme_classic())
(iqa_p2 <-ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA > "2000" &
ANO_COLETA <= "2010"),
aes(CODIGO,
IQA, na.rm = TRUE))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=19,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=19,
ymax=36,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=36,
ymax=51,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=51,
ymax=79,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=79,
ymax=Inf,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65),
na.rm = TRUE)+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7,
na.rm = TRUE)+
labs(title = "Variação do IQA no período 2000-2010",
x="Estação",
y="")+
# geom_jitter(width = .05,
#             alpha=.2,
#             size=1.5,
#             color="black")+
scale_y_continuous(expand = expansion(mult = c(0,0)),
n.breaks = 6,
limits = c(-1,101))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900", "87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
# geom_line(aes(color="red"),
#           alpha=.0)+
# scale_color_manual("Legenda",
#                    guide="legend",
#                    values = c("Ótima"="#8dcdeb",
#                               "Boa"="#70c18c",
#                               "Regular"="#fcf7ab",
#                               "Ruim"="#eb5661",
#                               "Péssima"="#ac5079"))+
# guides(color=guide_legend(override.aes = list(linetype=c(1,1,1,1,1),
#                                               lwd=c(2,2,2,2,2),
#                                               shape=c(NA,NA,NA,NA,NA),
#                                               alpha=1)))+
theme(legend.position = "bottom")+
theme_classic())
(iqa_p3 <-ggplot(plan_wide_19902020 %>%
filter(ANO_COLETA > "2010" &
ANO_COLETA <= "2020"),
aes(CODIGO,
IQA, na.rm = TRUE))+
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=-Inf,
ymax=19,
alpha=1,
fill="#ac5079")+ #>pior classe
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=19,
ymax=36,
alpha=1,
fill="#eb5661")+ #classe 4
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=36,
ymax=51,
alpha=1,
fill="#fcf7ab")+ #classe 3
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=51,
ymax=79,
alpha=1,
fill="#70c18c")+ #classe 2
annotate("rect",
xmin=-Inf,
xmax=Inf,
ymin=79,
ymax=Inf,
alpha=1,
fill="#8dcdeb")+ #classe 1
stat_boxplot(geom = 'errorbar',
width=0.3,
position = position_dodge(width = 0.65),
na.rm = TRUE)+
geom_boxplot(fill='#F8F8FF',
color="black",
outlier.shape = 1, #se deixar NA fica só o jitter, se não, deixa 1
width= 0.7,
na.rm = TRUE)+
labs(title = "Variação do IQA no período 2010-2020",
x="Estação",
y="")+
# geom_jitter(width = .05,
#             alpha=.2,
#             size=1.5,
#             color="black")+
scale_y_continuous(expand = expansion(mult = c(0,0)),
n.breaks = 6,
limits = c(-1,101))+
scale_x_discrete(limits = c("87398500", "87398980", "87398900", "87398950", "87405500", "87406900", "87409900"))+
geom_smooth(method = "lm",
se=FALSE, #se deixar TRUE gera o intervalo de confiança de 95%
aes(group=1),
alpha=.5,
na.rm = TRUE,
size = 1)+
# geom_line(aes(color="red"),
#           alpha=.0)+
# scale_color_manual("Legenda",
#                    guide="legend",
#                    values = c("Ótima"="#8dcdeb",
#                               "Boa"="#70c18c",
#                               "Regular"="#fcf7ab",
#                               "Ruim"="#eb5661",
#                               "Péssima"="#ac5079"))+
# guides(color=guide_legend(override.aes = list(linetype=c(1,1,1,1,1),
#                                               lwd=c(2,2,2,2,2),
#                                               shape=c(NA,NA,NA,NA,NA),
#                                               alpha=1)))+
theme(legend.position = "bottom")+
theme_classic())
grid.arrange(iqa_p1, iqa_p2, iqa_p3, ncol = 3)
(sum_IQA_p3 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE))
)
lenght(IQA, na.rm = TRUE)
len(IQA, na.rm = TRUE)
(sum_IQA_p3 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE),
n =
length(IQA)
str_length(IQA, na.rm = TRUE))
length(IQA)
length(plan_wide_19902020$IQA)
(sum_IQA_p3 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE),
n =
length(IQA, na.rm = TRUE))
)
(sum_IQA_p3 <- plan_wide_19902020 %>%
select(CODIGO, IQA, ANO_COLETA) %>%
filter(ANO_COLETA>"2010" &
ANO_COLETA<="2020") %>%
group_by(CODIGO) %>%
summarize(
min =
min(IQA,
na.rm = TRUE),
q1 =
quantile(IQA, 0.25,
na.rm = TRUE),
median =
median(IQA,
na.rm = TRUE),
mean =
mean(IQA,
na.rm= TRUE),
q3 =
quantile(IQA, 0.75,
na.rm = TRUE),
max =
max(IQA,
na.rm = TRUE),
n =
length(IQA))
)
View(plan_wide_19902020)
